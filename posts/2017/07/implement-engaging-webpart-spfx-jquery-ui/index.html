<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>YPcode - Implement engaging WebPart with the SharePoint Framework and jQuery UI </title>
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://ypcode.io/posts/2017/07/implement-engaging-webpart-spfx-jquery-ui" />
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css?v=202007310928" />
    <meta name="generator" content="PVX WebContentGenerator" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"></script>
    <script src="/lib/jquery/dist/jquery.min.js"></script>
    <script src="/js/framework.js?v=202007310928"></script>
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css">
</noscript>
<style>
pre[class*=language-] {    
    margin-bottom: 1.5em;
}
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172372458-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172372458-1');
</script>

<style>
.social-links {
    display: inline-flex;
    width: 60%;
    margin:auto;
    justify-content: center;
    color: #807070;
}

.social-links a {
    margin-right: 15px;
}

.social-links a:hover {
    color: #9e1e28;
}

    .social-links svg {
        fill: currentColor;
        height: 18px;
    }
</style>
        <meta property="og:site_name" content="YPcode" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="Implement engaging WebPart with the SharePoint Framework and jQuery UI" />
            <meta property="og:description" content="Let's see how convenient it is to build an engaging application with SPFx and a bit of jQuery UI" />
        <meta property="og:url" content="https://ypcode.io/posts/2017/07/implement-engaging-webpart-spfx-jquery-ui" />
        <meta property="og:image" content="https://ypcode.io/images/2017/07/workbench-local-fake-data.png" />
        <meta property="article:publisher" content="https://www.facebook.com/yannick.plenevaux" />
        <meta property="article:published_time" content="2017-07-13 13:00:30Z" />
        <meta property="article:modified_time" content="2017-07-13 13:00:30Z" />
                <meta property="article:tag" content="HTML" />
                <meta property="article:tag" content="JavaScript" />
                <meta property="article:tag" content="jQuery" />
                <meta property="article:tag" content="jQuery UI" />
                <meta property="article:tag" content="JS" />
                <meta property="article:tag" content="PnP" />
                <meta property="article:tag" content="SharePoint" />
                <meta property="article:tag" content="SharePoint Framework" />
                <meta property="article:tag" content="SharePoint Online" />
                <meta property="article:tag" content="SPFx" />
                <meta property="article:tag" content="TypeScript" />
                <meta property="article:tag" content="Web Development" />
        <meta name="twitter:title" content="Implement engaging WebPart with the SharePoint Framework and jQuery UI" />
            <meta name="twitter:description" content="Let's see how convenient it is to build an engaging application with SPFx and a bit of jQuery UI" />
        <meta name="twitter:url" content="https://ypcode.io/posts/2017/07/implement-engaging-webpart-spfx-jquery-ui" />
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:image" content="https://ypcode.io/images/2017/07/workbench-local-fake-data.png" />
            <meta name="twitter:label1" content="Written by" />
            <meta name="twitter:data1" content="Yannick Plenevaux" />
            <meta name="twitter:label2" content="Filed under" />
            <meta name="twitter:data2" content="HTML, JavaScript, jQuery, jQuery UI, JS, PnP, SharePoint, SharePoint Framework, SharePoint Online, SPFx, TypeScript, Web Development" />
        <meta name="twitter:site" content="@yp_code" />
    <link rel="alternate" type="application/rss+xml" title="YPcode" href="https://ypcode.io/feed" />


    <script>
        var initialSiteContentHeight = null;
        function toggleMenu() {
            var menu = document.querySelector(".menu");
            var siteContent = document.querySelector(".site-content");
            if (menu && siteContent) {
                if (menu.classList.contains("visible")) {
                    menu.classList.remove("visible");
                } else {
                    menu.classList.add("visible");
                }
            }
        }
    </script>
</head>
<body>
    <div class="menu">
        <span class="menu-hamburger-icon" onclick="toggleMenu();">
            <svg xmlns="http://www.w3.org/2000/svg" 
                x="0px" 
                y="0px"
                width="30" 
                height="30"
                viewBox="0 0 172 172"
                style=" fill:#000000;">
                    <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M0,25.8v17.2h172v-17.2zM0,77.4v17.2h172v-17.2zM0,129v17.2h172v-17.2z"></path></g></g>
            </svg>
        </span>
        <a href="https://ypcode.io/">
            <h1 class="main-site-title">YPcode</h1>
            <hr class="sep main-site-title-sep"/>
            <h2 class="main-site-description">Experiences and research on Microsoft 365, Azure and modern web development</h2>
        </a>
        <nav class="navigation">
    <ul>
<li class="nav-item">
    <span class="link-icon icon-home" ></span><a class="nav-link" href="/" >Home</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/about-me/" >About me</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/projects-contrib/" >Projects &amp; Contributions</a>
</li><li class="nav-item">
    <span class="link-icon icon-speak" ></span><a class="nav-link" href="/pages/speaking/" >Speaking</a>
</li>    </ul>
</nav>
        
            <div class="main-site-author">
                    <img class="main-site-author-picture" src="/images/common/me.png" />
                    <h3 class="main-site-author-name">
                        Yannick Plenevaux
                    </h3>
                        <h3 class="main-site-author-description">
                                <span class="main-site-author-description-line">Microsoft 365 Solutions Architect</span>
                                <span class="main-site-author-description-line">Office Development MVP</span>
                        </h3>
            </div>

        <div class="menu-social-links">
            <p class="social-links">

    <a href="https://mvp.microsoft.com/en-us/PublicProfile/5003599?fullName=Yannick%20Plenevaux" target="_blank"
        title="Microsoft MVP" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
            <defs>
                <style>
                    .a {
                        fill: currentColor;
                    }

                    .b {
                        fill: #1d1d1d;
                    }
                </style>
            </defs>
            <rect class="a" width="50" height="50"></rect>
            <path class="b"
                d="M17.42,26.16a15.14,15.14,0,0,0-.22,1.59l-.07.48h0a14.16,14.16,0,0,0-.33-2l-1.82-7.89h-3.5v13h2.07V24.43c0-1.18,0-2.39-.09-3.61h.08l.35,2.3,2,8.19h2.28L20,23c.18-.9.31-1.63.39-2.18h.05q-.09,2-.09,2.94v7.55h2.14v-13H19.13Zm18.36.72h1a3.81,3.81,0,0,0,3-1.24,4.54,4.54,0,0,0,1.14-3.17,4.23,4.23,0,0,0-1-3.08A3.81,3.81,0,0,0,37,18.34H33.29v13h2.49Zm0-6.37h.83a1.62,1.62,0,0,1,1.25.52,2.25,2.25,0,0,1,.48,1.57c0,1.42-.57,2.13-1.7,2.13h-.86Zm-9.24,10.8h2.67l3.31-13H30l-1.8,8.5c-.09.47-.15.92-.19,1.34l-.05.35h-.06a12,12,0,0,0-.2-1.65l-1.8-8.54H23.32ZM25.26,46.75,3.75,25.24,25.24,3.75,46.75,25.26Z"
                transform="translate(-0.25 -0.25)"></path>
        </svg>
        </a>

    <a href="https://twitter.com/yp_code" target="_blank" title="Twitter" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
            </path>
        </svg>
    </a>

    <a href="https://github.com/ypcode" target="_blank" title="GitHub" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path
                d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
        </svg>
    </a>

    <a href="https://www.linkedin.com/in/yannickplenevaux" target="_blank" title="LinkedIn" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
            <path
                d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z">
            </path>
        </svg>
    </a>


    <a href="/feed.xml" target="_blank" title="RSS">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
            <path
                d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z">
            </path>
        </svg>
    </a>
</p>
        </div>
    </div>
   
    <div class="site-content">
        <main role="main" class="pb-3">
            <div class="content-item post">
    
    <div class="content-item-title">
        <span class="post-publishing-date">Jul 13, 2017</span>
        <h1>
            Implement engaging WebPart with the SharePoint Framework and jQuery UI
            <hr/>
        </h1>
    </div>

        <div class="content-item-featured-image-container">
            <img class="content-item-featured-image" src="https://ypcode.io/images/2017/07/workbench-local-fake-data.png" alt="Implement engaging WebPart with the SharePoint Framework and jQuery UI" />
        </div>
   
    <div class="content">
        <p>Hi SharePoint fellows,</p>
<p>In this post, I would like to demonstrate how easy it is to implement a really engaging and modern user experience in a SharePoint Framework client-side WebPart.</p>
<h2 id="the-requirements">The requirements</h2>
<p>The purpose of the WebPart is to present a Kanban Board view of a configured list.
The user will be able to change the items from a status to another using drag-and-drop.</p>
<ul>
<li>The source list will be configured through the WebPart properties.</li>
<li>The statuses are the choices of a ChoiceField in the list.</li>
<li>The status ChoiceField to use will also be configured through the WebPart properties.</li>
</ul>
<h2 id="implementation">Implementation</h2>
<ul>
<li>The UI will dynamically generate a column for each status in which each task will be contained in a tile.</li>
<li>We will leverage the natively supported Office UI Fabric CSS framework that will make our UI fully responsive and in line with the SharePoint modern look and feel.</li>
<li>For the drag-and-drop capability, we will use the popular jQuery UI library.</li>
<li>For manipulating the SharePoint data, we will use the sp-pnp-js library.</li>
</ul>
<p>This will be a very simplistic and, I would roughly say,  &quot;quick and dirty&quot; implementation.
The purpose here is to focus on possibilities and ease offered by SPFx.
You will see it is possible to build a real engaging WebPart with SPFx within 2 hours (1 hour for developping, 1 hour for CSS fine tuning ;) )*.</p>
<p>(* Obviously, for a real clean and scalable project, we would prefer a robust implementation with a well defined project structure, separation of concerns,...)</p>
<h2 id="lets-code">Let's code !</h2>
<ul>
<li>Create a folder named <strong>kanban-webpart-demo</strong>/</li>
<li>open it from a console, type the famous <strong><em>yo @microsoft/sharepoint</em></strong> and enter the values as following</li>
</ul>
<p><img src="/images/2017/07/yo-sp1.png" alt="yo-sp" /></p>
<p>When the scaffolding process is finished, let's first install the required packages.
In the console, type the following command:</p>
<pre><code class="language-bash">&gt; npm install jquery jquery-ui sp-pnp-js --save
</code></pre>
<h3 id="the-model">The model</h3>
<p>This Kanban Board will display and manage task items, we will then declare an interface with the relevant properties for us. In the <strong>kanbanBoard/</strong> folder, let's create a <strong>models/</strong> folder that will contain a <strong>ITask.ts</strong> file.</p>
<pre><code class="language-typescript">export interface ITask {     
  Id: number;     
  Title: string;     
  Status: string; 
}
</code></pre>
<p>In a first step, we will use hard coded fake data. In the beginning of our WebPart class, let's add the collection of groups and the collection of tasks.</p>
<pre><code class="language-typescript"> export default class KanbanBoardWebPart extends BaseClientSideWebPart&lt;IKanbanBoardWebPartProps&gt; {
   // ....
  private statuses: string[] = [&quot;Not Started&quot;, &quot;In Progress&quot;, &quot;Completed&quot;];
  private tasks: ITask[] = [
    {
      Id: 1,
      Status: &quot;Not Started&quot;,
      Title: &quot;Task 01&quot;
    },
    {
      Id: 2,
      Status: &quot;Not Started&quot;,
      Title: &quot;Task 02&quot;
    },
    {
      Id: 3,
      Status: &quot;In Progress&quot;,
      Title: &quot;Task 03&quot;
    },
    {
      Id: 4,
      Status: &quot;In Progress&quot;,
      Title: &quot;Task 04&quot;
    },
    {
      Id: 5,
      Status: &quot;Completed&quot;,
      Title: &quot;Task 05&quot;
    },
    {
      Id: 6,
      Status: &quot;Completed&quot;,
      Title: &quot;Task 06&quot;
    }
  ];
// ...
}
</code></pre>
<h3 id="the-user-interface">The User Interface</h3>
<p>We create now a private <strong>_<em>renderBoard</em></strong>() method that will generate the dynamic HTML and stick it into the WebPart.
This method will use a <strong>_<em>getColumnSizeClassName</em></strong>() helper method that returns the appropriate Office UI CSS class name according to the number of columns to display.
In the <strong>KanbanBoardWebPart</strong> class, bring the following changes.
The <strong><em>render</em></strong>() method must also call our new <strong>_<em>renderBoard</em></strong>() method</p>
<pre><code class="language-typescript">// ....
export const LAYOUT_MAX_COLUMNS = 12;

export default class KanbanBoardWebPart extends BaseClientSideWebPart&lt;IKanbanBoardWebPartProps&gt; {

  // ....

  public render(): void {
    this._renderBoard();
  }

  private _getColumnSizeClassName(columnsCount: number): string {
    if (columnsCount &lt; 1) {
      console.log(&quot;Invalid number of columns&quot;);
      return &quot;&quot;;
    }

    if (columnsCount &gt; LAYOUT_MAX_COLUMNS) {
      console.log(&quot;Too many columns for responsive UI&quot;);
      return &quot;&quot;;
    }

    let columnSize = Math.floor(LAYOUT_MAX_COLUMNS / columnsCount);

    console.log(&quot;Column size =&quot; + columnSize);
    return &quot;ms-u-sm&quot; + (columnSize || 1);
  }

 /**
   * Generates and inject the HTML of the Kanban Board
   */
  private _renderBoard(): void {
    let columnSizeClass = this._getColumnSizeClassName(this.statuses.length);

    // The begininning of the WebPart
    let html = `
      &lt;div class=&quot;${styles.kanbanBoard}&quot;&gt;
        &lt;div class=&quot;${styles.container}&quot;&gt;
          &lt;div class=&quot;ms-Grid-row ${styles.row}&quot;&gt;`;

    // For each status
    this.statuses.forEach(status =&gt; {
      // Append a new Office UI Fabric column with the appropriate width to the row
      html += `&lt;div class=&quot;${styles.kanbanColumn} ms-Grid-col ${columnSizeClass}&quot; data-status=&quot;${status}&quot;&gt;
                  &lt;h3 class=&quot;ms-fontColor-themePrimary&quot;&gt;${status}&lt;/h3&gt;`;
      // Get all the tasks in the current status
      let currentGroupTasks = this.tasks.filter(t =&gt; t.Status == status);
      // Add a new tile for each task in the current column
      currentGroupTasks.forEach(task =&gt; {
        html += `&lt;div class=&quot;${styles.task}&quot; data-taskid=&quot;${task.Id}&quot;&gt;
                        &lt;div class=&quot;ms-fontSize-xl&quot;&gt;${task.Title}&lt;/div&gt;
                      &lt;/div&gt;`;
      });
      // Close the column element
      html += `&lt;/div&gt;`;
    });

    // Ends the WebPart HTML
    html += `&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;`;

    // Apply the generated HTML to the WebPart DOM element
    this.domElement.innerHTML = html;

    console.log(&quot;Kanban columns found : &quot; + $(&quot;.kanban-column&quot;).length);
   // Make the kanbanColumn elements droppable areas
    let webpart = this;
    $(`.${styles.kanbanColumn}`).droppable({
      tolerance: &quot;intersect&quot;,
      accept: `.${styles.task}`,
      activeClass: &quot;ui-state-default&quot;,
      hoverClass: &quot;ui-state-hover&quot;,
      drop: (event, ui) =&gt; {
        // Here the code to execute whenever an element is dropped into a column
        let taskItem = $(ui.draggable);
        let source = taskItem.parent();
        let previousStatus = source.data(&quot;status&quot;);
        let taskId = taskItem.data(&quot;taskid&quot;);
        let target = $(event.target);
        let newStatus = target.data(&quot;status&quot;);
        taskItem.appendTo(target);

        // If the status has changed, apply the changes
        if (previousStatus != newStatus) {
          webpart.changeTaskStatus(taskId, newStatus);
        }
      }
    });

    console.log(&quot;Task items found : &quot; + $(&quot;.task&quot;).length);
    // Make the task items draggable
    $(`.${styles.task}`).draggable({
      classes: {
        &quot;ui-draggable-dragging&quot;: styles.dragging
      },
      opacity: 0.7,
      helper: &quot;clone&quot;,
      cursor: &quot;move&quot;,
      revert: &quot;invalid&quot;
    });
  }

  private changeTaskStatus(taskId: number, newGroup: string) {
    console.log(`Task ${taskId} moved to group ${newGroup}`);
  }

  // ....
}
</code></pre>
<p>We need now to add some CSS for our custom elements, let's replace the content of the <strong>KanbanBoard.module.scss</strong> file with the following</p>
<pre><code class="language-scss">.kanbanBoard {
  .container {
    max-width: 700px;
    margin: 0px auto;
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 25px 50px 0 rgba(0, 0, 0, 0.1);
    position: relative;
    background-color: #FEFEFF;
    padding: 3px;
    min-height: 500px;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .row {
    display: flex;
  }

.kanbanColumn {
  vertical-align: top;
  min-height: 500px;

  h3 {
    text-align: center;
  }
}

.kanbanColumn:not(:last-child) {
  border-right: 2px dashed #eaeaea;
}

.task {
  position: relative;
  padding: 8px;
  width: 90%;
  margin: auto;
  margin-bottom: 5px;
  background-color: #FEFFFF;
  border: 1px solid #eaeaea;
  min-height: 80px;

  div {
    cursor: default;
  }

  span {
    cursor: default;
  }

  .taskName {
  font-weight: bold;
  font-size: 18px;
  display: block;
  }
}

 .task.dragging {
      background-color: #FBFBFB;
      border: 1px solid black;
      z-index: 50;
  }

.task:hover {
  border-width: 3px;
  border: 1px solid blue;
}

}
</code></pre>
<p>To have full features of the jQuery UI drag-and-drop, we also need to include some jQuery CSS. (you can also consider customizing it by yourself).
In order to achieve that, we have to load the CSS dynamically using the SPComponentLoader.
We will take the CSS file from the jQuery CDN Make the following changes in the <strong>KanbanBoardWebPart.ts</strong> file</p>
<pre><code class="language-typescript">// ...
import { SPComponentLoader } from '@microsoft/sp-loader';
// ...
export default class KanbanBoardWebPart extends BaseClientSideWebPart&lt;IKanbanBoardWebPartProps&gt; {
// ...
  constructor() {
    super();
    SPComponentLoader.loadCss('https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.min.css');
  }
// ...
}
</code></pre>
<p>We can now test our WebPart in the local Workbench with the hardcoded fake data, enter the <strong><em>gulp serve</em></strong> command in the console and let's check the WebPart behaves as expected. You should see something similar to the figure below.
Try to drag and drop task tiles from a column to another to verify everything works fine.</p>
<p><img src="/images/2017/07/workbench-local-fake-data.png" alt="workbench-local-fake-data" />  </p>
<h3 id="the-real-model-sharepoint-data">The REAL model (SharePoint data)</h3>
<p>Now that the UI is what we expect, we have to integrate it with real SharePoint data. As stated above, the data will come from a configured list and the Status field must be configurable as well. We will then have to play with not only Tasks but also Lists and Fields, create two new files under the <strong>models/</strong> folder</p>
<pre><code class="language-typescript">export interface IFieldInfo {     
  Title: string;     
  InternalName: string;     
  TypeAsString: string;     
  Choices?: string[]; 
}
</code></pre>
<p>and</p>
<pre><code class="language-typescript">import { IFieldInfo } from &quot;./IFieldInfo&quot;;

export interface IListInfo {
    Id: string;
    Title: string;
    Fields: IFieldInfo[];
}
</code></pre>
<p>Let's now define the properties we need for our WebPart to be configurable, update the content of <strong>IKanbanBoardWebPartProps.ts</strong> with</p>
<pre><code class="language-typescript">export interface IKanbanBoardWebPartProps {
  tasksListId: string;
  statusFieldName: string;
}
</code></pre>
<p>We can also configure the default values for these settings in the <strong>KanbanBoardWebPart.manifest.json</strong> file.
Set the following as the value of the <strong><em>properties</em></strong> in the <strong><em>preconfiguredEntries</em></strong> section.</p>
<pre><code class="language-json">{
  &quot;tasksListId&quot; : &quot;&quot;,_
  &quot;statusFieldName&quot;: &quot;Status&quot;
}
</code></pre>
<p>Back to the <strong><em>KanbanBoardWebPart.ts</em></strong> file, adapt the class as the following for the settings to be configurable from the Property Pane.</p>
<pre><code class="language-typescript">// ...
import {
  BaseClientSideWebPart,
  IPropertyPaneConfiguration,
  PropertyPaneTextField,
  PropertyPaneDropdown
} from '@microsoft/sp-webpart-base';
import { escape } from '@microsoft/sp-lodash-subset';
// ...

import { ITask } from &quot;./models/ITask&quot;;
import { IListInfo } from &quot;./models/IListInfo&quot;;
import { IFieldInfo } from &quot;./models/IFieldInfo&quot;;
// ...
export default class KanbanBoardWebPart extends BaseClientSideWebPart&lt;IKanbanBoardWebPartProps&gt; {

  private statuses: string[] = [];
  private tasks: ITask[] = [];
  private availableLists: IListInfo[] = [];
  // ...
  private _getAvailableFieldsFromCurrentList(): IFieldInfo[] {
    if (!this.properties.tasksListId)
      return [];

    let filteredListInfo = this.availableLists.filter(l =&gt; l.Id == this.properties.tasksListId);
    if (filteredListInfo.length != 1)
      return [];

    return filteredListInfo[0].Fields.filter(f =&gt; f.TypeAsString == &quot;Choice&quot;);
  }

  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {
    return {
      pages: [
        {
          header: {
            description: &quot;Settings&quot;
          },
          groups: [
            {
              groupName: &quot;Tasks source configuration&quot;,
              groupFields: [
                PropertyPaneDropdown('tasksListId', {
                  label: &quot;Source Task list&quot;,
                  options: this.availableLists.map(l =&gt; ({
                    key: l.Id,
                    text: l.Title
                  }))
                }),
                PropertyPaneDropdown('statusFieldName', {
                  label: &quot;Status field Internal name&quot;,
                  options: this._getAvailableFieldsFromCurrentList().map(f =&gt; ({
                    key: f.InternalName,
                    text: f.Title
                  }))
                })
              ]
            }
          ]
        }
      ]
    };
  }
}
</code></pre>
<h3 id="read-and-write-data-to-sharepoint-with-the-pnp-js-core-library">Read and Write data to SharePoint with the PnP JS Core library</h3>
<p>In order to fetch and update data from and to SharePoint, we will need to call the REST API; we are totally able to do it with the native SPFx <strong>SPHttpClient</strong> class but the main issue with this one is that we have to build manually the URL string which, in many cases, leads to issues (from simple typos to badly generated strings in more complex scenarios).</p>
<p>Plus you have to know the exact syntax, spend time on Google, in the Reference Docs instead of coding each time you need a new thing.</p>
<p>In order to limit these issues and to improve your productivity, you can use the PnP JS Core library.
It will build the REST URLs in the correct syntax for you and will tell you what's available with the intellisense in your IDE (thanks to TypeScript definition files).</p>
<p>Let's write our data manipulation methods, adapt the <strong>KanbanBoardWebPart.ts</strong> file like this:</p>
<pre><code class="language-typescript">// ...
import pnp from &quot;sp-pnp-js&quot;;
// ...
export default class KanbanBoardWebPart extends BaseClientSideWebPart&lt;IKanbanBoardWebPartProps&gt; {
  // ...
  public onInit(): Promise&lt;any&gt; {
    return super.onInit().then(_ =&gt; {
      // Configure PnP Js for working seamlessly with SPFx
      pnp.setup({
        spfxContext: this.context
      });
    })
      // Load the available lists in the current site
      .then(() =&gt; this._loadAvailableLists())
      .then((lists: IListInfo[]) =&gt; this.availableLists = lists);
  }

  private _loadAvailableLists(): Promise&lt;IListInfo[]&gt; {
       return pnp.sp.web.lists.expand(&quot;Fields&quot;).select(&quot;Id&quot;, &quot;Title&quot;, &quot;Fields/Title&quot;, &quot;Fields/InternalName&quot;, &quot;Fields/TypeAsString&quot;).get();
  }

  private _loadTasks(): Promise&lt;ITask[]&gt; {
    return pnp.sp.web.lists.getById(this.properties.tasksListId).items.select(&quot;Id&quot;, &quot;Title&quot;, this.properties.statusFieldName).get()
      .then((results: ITask[]) =&gt; results &amp;&amp; results.map(t =&gt; ({
        Id: t.Id,
        Title: t.Title,
        Status: t[this.properties.statusFieldName]
      })));
  }

  private _loadStatuses(): Promise&lt;string[]&gt; {
    console.log(&quot;Load statuses...&quot;);
    return pnp.sp.web.lists.getById(this.properties.tasksListId).fields.getByInternalNameOrTitle(this.properties.statusFieldName).get()
      .then((fieldInfo: IFieldInfo) =&gt; fieldInfo.Choices || []);
  }

  public render(): void {
    // Only if properly configured
    if (this.properties.statusFieldName &amp;&amp; this.properties.tasksListId) {
      // Load the data
      this._loadStatuses()
        .then((statuses: string[]) =&gt; this.statuses = statuses)
        .then(() =&gt; this._loadTasks())
        .then((tasks: ITask[]) =&gt; this.tasks = tasks)
        // And then render
        .then(() =&gt; this._renderBoard())
        .catch(error =&gt; {
          console.log(error);
          console.log(&quot;An error occured while loading data...&quot;);
        });
    } else {
      this.domElement.innerHTML = &quot;&lt;div&gt;Please configure the WebPart&lt;/div&gt;&quot;;
    }
  }
 // ...
  private changeTaskStatus(taskId: number, newStatus: string) {
    // Set the value for the configured &quot;status&quot; field
    let fieldsToUpdate = {};
    fieldsToUpdate[this.properties.statusFieldName] = newStatus;

    // Update the property on the list item
    pnp.sp.web.lists.getById(this.properties.tasksListId).items.getById(taskId).update(fieldsToUpdate);
  }
// ...
}
</code></pre>
<p>We can now test our WebPart against a real SharePoint site.</p>
<p>First of all, we need to create our source SharePoint list. Go to your SharePoint site, create a standard task list and create some tasks  in it.</p>
<p>Run the <strong>gulp serve</strong> command and go to <strong>https://<yourtenant>.sharepoint.com/sites/<yoursite>/_layouts/15/workbench.aspx</strong></p>
<p>On the SharePoint hosted Workbench, add your WebPart. you will be asked to configure it.</p>
<p><img src="/images/2017/07/configure-wp.png" alt="configure-wp" /></p>
<ol>
<li>Select the Task list you have just created.</li>
<li>Select the field you want to use for grouping (e.g. &quot;Task Status&quot;)</li>
</ol>
<p>And see it magically updating :</p>
<p><img src="/images/2017/07/configure-wp21.png" alt="configure-wp2" /></p>
<p>Let's first verify the data is correct</p>
<p><img src="/images/2017/07/tasklist01.png" alt="tasklist01" /></p>
<p>Move a task from a column to another and check the data is properly updated in the list</p>
<p><img src="/images/2017/07/webpart-update-data.png" alt="webpart-update-data.png" />
<img src="/images/2017/07/tasklist02.png" alt="tasklist02" /></p>
<p>YEAAAAH It works ! What..? Did you doubt?</p>
<p>Let's now verify it is really dynamic and responsive.
Go to your Tasks list settings and modifiy the available values in the Task Status field.</p>
<p><img src="/images/2017/07/taskstatusupdates.png" alt="taskstatusupdates" /></p>
<p>Let's refresh our Workbench:</p>
<p><img src="/images/2017/07/more-statuses.png" alt="more-statuses" /></p>
<p>(* Since we are using Office UI Fabric that has a Responsive Grid based on 12 columns, and I wanted my columns to be equal in width, in the case of 5 columns, the size of a column is 12 / 5 = 2 as whole number, it is why we can see a blank space on the right)</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this post, we saw how to implement an engaging and easy to configure WebPart with SharePoint Framework.
This implementation is not perfect in terms of code and project structure (and maybe not optimized since all the lists are loaded on startup).
It is actually on purpose because I want to demonstrate in a upcoming post how we can write reusable, scalable and beautiful code with SPFx.
You can get the entire solution on my github repo</p>
<p><a href="https://github.com/ypcode/spfx-kanban">here</a></p>
<p>I hope you liked it, give your feedback !</p>
<p>See you soon,</p>
<p>Yannick</p>

    </div>

    <div class="foot-random-posts">
        <div class="random-posts-container">
<h5>Other posts</h5>
<div id="random-posts" class="posts d-flex flex-wrap align-content-stretch">
</div>

<script>
    WCG.execute((db) => {

        const renderCard = (placeholderSelector, item) => {
            const placeholder = $(placeholderSelector);
            $(`<div class="post-card card box-shadow">
                <a href="${item.RelativeUrl}">
                    <img class="post-featured-image card-img-top" src="${item.FeaturedImage}" alt="${item.FeaturedImageAlt}" />
                </a>
                <div class="post-caption card-body">
                    <h5 class="post-title card-title">
                        <a href="${item.RelativeUrl}">${item.Title}</a>
                    </h5>
                    <span class="post-publishing-date">${moment(item.PublishedOn).format("MMM DD, YYYY")}</span>
                    <p class="post-summary card-text">
                        ${item.Description||''}
                    </p>
                    <div class="post-keywords">
                        ${item.Keywords.map(k => `<span class="post-keyword">#${k.replace(" ","")}</span>`).join(" ")}
                    </div>
                </div>
            </div>
            `).appendTo(placeholder);
        };

        const [firstPost, secondPost] = db.getRandomPosts(2);
        renderCard("#random-posts", firstPost);
        renderCard("#random-posts", secondPost);
    });
</script>
</div>
    </div>

     <div class="post-comments">
            <div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://ypcode.io/posts/2017/07/implement-engaging-webpart-spfx-jquery-ui';
this.page.identifier = 'src\content\posts\2017-07-13-implement-engaging-webpart-with-the-sharepoint-framework-and-jquery-ui.md';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://ypcode-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
</div>
        </main>

        <footer class="border-top footer">
                &copy; Copyrights 2020 - YPcode - Yannick Plenevaux
        </footer>
    </div>

    <script src="/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/site.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" ></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.js" ></script>

        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-aspnet.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-c.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-clike.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-csharp.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-css-extras.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-scss.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-markup.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-javascript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-jsx.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-powershell.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-typescript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.js" ></script>



</body>
</html>
