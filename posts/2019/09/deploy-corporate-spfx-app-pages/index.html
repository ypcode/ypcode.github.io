<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>YPcode</title>
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://ypcode.io/posts/2019/09/deploy-corporate-spfx-app-pages" />
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css?v=202007220100" />
    <meta name="generator" content="PVX WebContentGenerator" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"></script>
    <script src="/lib/jquery/dist/jquery.min.js"></script>
    <script src="/js/framework.js?v=202007220100"></script>
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css">
</noscript>
<style>
pre[class*=language-] {    
    margin-bottom: 1.5em;
}
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172372458-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172372458-1');
</script>

<style>
.social-links {
    display: inline-flex;
    width: 60%;
    margin:auto;
    justify-content: center;
    color: #807070;
}

.social-links a {
    margin-right: 15px;
}

.social-links a:hover {
    color: #9e1e28;
}

    .social-links svg {
        fill: currentColor;
        height: 18px;
    }
</style>
        <meta property="og:site_name" content="YPcode" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="Deploy corporate SPFx app pages" />
            <meta property="og:description" content="Check out how to deploy a corporate SPFx app part page to your SharePoint" />
        <meta property="og:url" content="https://ypcode.io/posts/2019/09/deploy-corporate-spfx-app-pages" />
        <meta property="og:image" content="/images/2019/09/scriptexec.png?r=202007220100" />
        <meta property="article:publisher" content="https://www.facebook.com/yannick.plenevaux" />
        <meta property="article:published_time" content="2019-09-23 05:30:34Z" />
        <meta property="article:modified_time" content="2019-09-23 05:30:34Z" />
                <meta property="article:tag" content="JavaScript" />
                <meta property="article:tag" content="JSON" />
                <meta property="article:tag" content="Office 365" />
                <meta property="article:tag" content="PnP" />
                <meta property="article:tag" content="PowerShell" />
                <meta property="article:tag" content="SharePoint" />
                <meta property="article:tag" content="SharePoint Framework" />
                <meta property="article:tag" content="SharePoint Online" />
                <meta property="article:tag" content="SharePointFullPage" />
                <meta property="article:tag" content="SingleWebPartAppPage" />
                <meta property="article:tag" content="SPA" />
                <meta property="article:tag" content="SPFx" />
                <meta property="article:tag" content="Tenant" />
                <meta property="article:tag" content="TypeScript" />
        <meta name="twitter:title" content="Deploy corporate SPFx app pages" />
            <meta name="twitter:description" content="Check out how to deploy a corporate SPFx app part page to your SharePoint" />
        <meta name="twitter:url" content="https://ypcode.io/posts/2019/09/deploy-corporate-spfx-app-pages" />
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:image" content="/images/2019/09/scriptexec.png?r=202007220100" />
            <meta name="twitter:label1" content="Written by" />
            <meta name="twitter:data1" content="Yannick Plenevaux" />
            <meta name="twitter:label2" content="Filed under" />
            <meta name="twitter:data2" content="JavaScript, JSON, Office 365, PnP, PowerShell, SharePoint, SharePoint Framework, SharePoint Online, SharePointFullPage, SingleWebPartAppPage, SPA, SPFx, Tenant, TypeScript" />
        <meta name="twitter:site" content="@yp_code" />
    <link rel="alternate" type="application/rss+xml" title="YPcode" href="https://ypcode.io/feed" />


    <script>
        var initialSiteContentHeight = null;
        function toggleMenu() {
            var menu = document.querySelector(".menu");
            var siteContent = document.querySelector(".site-content");
            if (menu && siteContent) {
                if (menu.classList.contains("visible")) {
                    menu.classList.remove("visible");
                } else {
                    menu.classList.add("visible");
                }
            }
        }
    </script>
</head>
<body>
    <div class="menu">
        <span class="menu-hamburger-icon" onclick="toggleMenu();">
            <svg xmlns="http://www.w3.org/2000/svg" 
                x="0px" 
                y="0px"
                width="30" 
                height="30"
                viewBox="0 0 172 172"
                style=" fill:#000000;">
                    <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M0,25.8v17.2h172v-17.2zM0,77.4v17.2h172v-17.2zM0,129v17.2h172v-17.2z"></path></g></g>
            </svg>
        </span>
        <a href="https://ypcode.io/">
            <h1 class="main-site-title">YPcode</h1>
            <hr class="sep main-site-title-sep"/>
            <h2 class="main-site-description">Experiences and research on Microsoft 365, Azure and modern web development</h2>
        </a>
        <nav class="navigation">
    <ul>
<li class="nav-item">
    <span class="link-icon icon-home" ></span><a class="nav-link" href="/" >Home</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/about-me/" >About me</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/projects-contrib/" >Projects &amp; Contributions</a>
</li>    </ul>
</nav>
        
            <div class="main-site-author">
                    <img class="main-site-author-picture" src="/images/common/me.png" />
                    <h3 class="main-site-author-name">
                        Yannick Plenevaux
                    </h3>
                        <h3 class="main-site-author-description">
                                <span class="main-site-author-description-line">Microsoft 365 Solutions Architect</span>
                                <span class="main-site-author-description-line">Office Development MVP</span>
                        </h3>
            </div>

        <div class="menu-social-links">
            <p class="social-links">

    <a href="https://mvp.microsoft.com/en-us/PublicProfile/5003599?fullName=Yannick%20Plenevaux" target="_blank"
        title="Microsoft MVP" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
            <defs>
                <style>
                    .a {
                        fill: currentColor;
                    }

                    .b {
                        fill: #1d1d1d;
                    }
                </style>
            </defs>
            <rect class="a" width="50" height="50"></rect>
            <path class="b"
                d="M17.42,26.16a15.14,15.14,0,0,0-.22,1.59l-.07.48h0a14.16,14.16,0,0,0-.33-2l-1.82-7.89h-3.5v13h2.07V24.43c0-1.18,0-2.39-.09-3.61h.08l.35,2.3,2,8.19h2.28L20,23c.18-.9.31-1.63.39-2.18h.05q-.09,2-.09,2.94v7.55h2.14v-13H19.13Zm18.36.72h1a3.81,3.81,0,0,0,3-1.24,4.54,4.54,0,0,0,1.14-3.17,4.23,4.23,0,0,0-1-3.08A3.81,3.81,0,0,0,37,18.34H33.29v13h2.49Zm0-6.37h.83a1.62,1.62,0,0,1,1.25.52,2.25,2.25,0,0,1,.48,1.57c0,1.42-.57,2.13-1.7,2.13h-.86Zm-9.24,10.8h2.67l3.31-13H30l-1.8,8.5c-.09.47-.15.92-.19,1.34l-.05.35h-.06a12,12,0,0,0-.2-1.65l-1.8-8.54H23.32ZM25.26,46.75,3.75,25.24,25.24,3.75,46.75,25.26Z"
                transform="translate(-0.25 -0.25)"></path>
        </svg>
        </a>

    <a href="https://twitter.com/yp_code" target="_blank" title="Twitter" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
            </path>
        </svg>
    </a>

    <a href="https://github.com/ypcode" target="_blank" title="GitHub" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path
                d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
        </svg>
    </a>

    <a href="https://www.linkedin.com/in/yannickplenevaux" target="_blank" title="LinkedIn" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
            <path
                d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z">
            </path>
        </svg>
    </a>


</p>
        </div>
    </div>
   
    <div class="site-content">
        <main role="main" class="pb-3">
            <div class="content-item post">
    
    <div class="content-item-title">
        <span class="post-publishing-date">Sep 23, 2019</span>
        <h1>
            Deploy corporate SPFx app pages
            <hr/>
        </h1>
    </div>

        <div class="content-item-featured-image-container">
            <img class="content-item-featured-image" src="/images/2019/09/scriptexec.png?r=202007220100" alt="Deploy corporate SPFx app pages" />
        </div>
   
    <div class="content">
        <p>Hi SharePoint devs !</p>
<p>Today I am going to tackle a need many of us, SPFx developers, will face some day. Deploy a SPFx app, but not a WebPart, not an extension, a <strong>Single Page App</strong>. Okay.. What's the deal, is it not deployed the same way, you might say ? Well, it is, but that might actually be an issue, if you don't want it to be added or edited by end users. Let's get into it !</p>
<h1 id="how-to-develop-a-single-webpart-app-page-in-spfx">How to develop a Single WebPart app page in SPFx ?</h1>
<p>It is actually really simple, there is 1 attribute in the manifest to modify, and that's it ! For this article I created a brand new SPFx WebPart solution (no-framework) in which I only changed some CSS for rendering purpose, slightly changed the manifest, but, really, there isn't any other changes. Let's check the WebPart manifest file</p>
<pre><code class="language-jsonc">{
    &quot;$schema&quot;: &quot;https://developer.microsoft.com/json-schemas/spfx/client-side-web-part-manifest.schema.json&quot;,
    &quot;id&quot;: &quot;85c66304-0802-417a-a753-de96fea19565&quot;,
    &quot;alias&quot;: &quot;MySinglePageAppWebPart&quot;,
    &quot;componentType&quot;: &quot;WebPart&quot;,
    // The &quot;*&quot; signifies that the version should be taken from the package.json   
    &quot;version&quot;: &quot;*&quot;,
    &quot;manifestVersion&quot;: 2,
    // If true, the component can only be installed on sites where Custom Script is allowed.   
    // Components that allow authors to embed arbitrary script code should set this to true.   
    // https://support.office.com/en-us/article/Turn-scripting-capabilities-on-or-off-1f2c515f-5d7e-448a-9fd7-835da935584f   
    &quot;requiresCustomScript&quot;: false,
    &quot;hiddenFromToolbox&quot;: true,
    &quot;supportedHosts&quot;: [
        &quot;SharePointWebPart&quot;
    ],
    &quot;preconfiguredEntries&quot;: [
        {
            &quot;groupId&quot;: &quot;5c03119e-3074-46fd-976b-c60198311f70&quot;, // Other     
            &quot;group&quot;: {
                &quot;default&quot;: &quot;Other&quot;
            },
            &quot;title&quot;: {
                &quot;default&quot;: &quot;MySPA&quot;
            },
            &quot;description&quot;: {
                &quot;default&quot;: &quot;A Single Page Application developed with SPFx&quot;
            },
            &quot;officeFabricIconFontName&quot;: &quot;Page&quot;,
            &quot;properties&quot;: {
                &quot;description&quot;: &quot;Hello dear user&quot;
            }
        }
    ]
}
</code></pre>
<p>If you take a look at line 16 <strong>supportedHosts</strong>, in VS Code, for instance, you will see that you can add other entries, such as <em>SharePointFullPage</em> , this setting will allow you to &quot;embed&quot; your WebPart in a dedicated page (with only this WebPart and nothing else). If we give it a try, let's add this entry, bundle and package solution, deploy it to app catalog.
Now we see, If I add a new page from the command bar on the home page* I can see this</p>
<p><img src="/images/2019/09/newpage.png" alt="newpage" />
<img src="/images/2019/09/apppagepicker.png" alt="apppagepicker.png" />  </p>
<ul>
<li>on the home page <strong>only</strong>, it looks like it is the only location from where we can get to the page templates picker, either the new button from the site pages library or the link from the up right corner gear will directly create an article page
If I click it, I have indeed a full page with only my WebPart ! Great !</li>
</ul>
<p>However, the creator of the page has to provide:</p>
<ul>
<li>The title of the page: pretty obvious</li>
<li>But also the <strong>configuration of the page !</strong></li>
</ul>
<p>In some scenarios, that totally makes sense...
But in others, that is something we might want to get rid of !
Moreover, not only the creator but all the users with Edit permission (meaning the Members by default on Modern team sites) on the page will be able to update the configuration.</p>
<p>It is quite a consistent behavior in SharePoint, and basically, I would not want it to be different because all of the inconsistencies it would cause...</p>
<p>So it is as simple as changing 1 parameter in the manifest to convert a WebPart into an application page.</p>
<h1 id="deploy-corporate-applications-on-intranet">Deploy corporate applications on Intranet</h1>
<p>All that said, a scenario that many organizations will probably require is to have corporate applications installed directly in their intranet, and it will be more than likely out of question that regular users are able to change anything in the application configuration.
It will probably also be required that regular users are not able to add new instances of the application...
From the page templates picker, Members will be able to do that as well. Regarding this very last point, I was actually expecting the <em><strong>hiddenFromToolbox</strong></em> flag in the manifest can make the app page hidden from the page templates picker but it doesn't...</p>
<p>After a bit of searching through <a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/single-part-app-pages">the official docs</a> and <a href="https://github.com/SharePoint/sp-dev-docs/issues/3832">GitHub issues</a>.</p>
<p>I realized the only way to achieve my need is actually to create a regular Modern page, add My WebPart to it, and then update the modern page layout.</p>
<p>Moreover, to make sure, no regular user can alter my application page, I will make sure that only owners (or any other wanted group) has full control on the page, all other will only have read permissions (It is classical SharePoint permissions management).</p>
<h1 id="a-pnp-powershell-script-to-deploy-my-single-page-application">A PnP PowerShell script to deploy my Single Page application</h1>
<p>First of all, to make sure my app page cannot be added by any editors of the sites, I will remove the supported host we added earlier, the WebPart manifest will be exactly like the one shown above.</p>
<p>You'll probably notice that in that manifest, the WebPart is then a regular WebPart (it is important for the PnP PowerShell script to work),  I also added the flag &quot;hiddenFromToolbox&quot; set to true to make sure we cannot add our application as a WebPart on any other page. From the SPFx solution side, it is the only thing to take care of, so <strong>basically have a regular WebPart solution, with the &quot;hiddenFromToolbox&quot; flag set.</strong></p>
<p>Let's then write the script!
Obviously PnP PowerShell will be our ally here !
The steps of the scripts will be :</p>
<ol>
<li>Connect to site with PnP PowerShell.</li>
<li>Will Get or Create the page we want to be our application page.</li>
<li>Get our component from the available components on the site ( the $appName parameter must be set from the value of <strong><em>preconfiguredEntries.title.default</em></strong> in the WebPart manifest.json file ).</li>
<li>Add the WebPart to the page.</li>
<li>Leave only the full control permissions for owners of the site.</li>
<li>Change the layout of the modern page to &quot;<strong><em>SingleWebPartAppPage</em></strong>&quot; and publish the page.</li>
</ol>
<p>This script has been tested on a fresh Modern Team Site, the permissions to update might be different if you already customized them.</p>
<pre><code class="language-powershell">param(     
  [Parameter(Mandatory = $true)]     
  [string]$web,    
  [Parameter(Mandatory = $true)]     
  [string]$pageName,     
  [Parameter(Mandatory = $true)]     
  [string]$appName,     
  $appConfig,     
  $pnpCredentials 
)  
Write-Host &quot;Ensure connection to SharePoint site...&quot; -ForegroundColor Yellow 
try {     
  $ctx = Get-PnPContext -ErrorAction Ignore     
  If ($null -eq $ctx) {         
    If ($null -eq $pnpCredentials) {             
      Connect-PnPOnline $web         
    } Else {             
      Connect-PnPOnline $web -Credentials $pnpCredentials         
    }     
  }     
  Write-Host &quot;Connected to SharePoint site.&quot; -ForegroundColor Green 
} catch {     
  throw &quot;Cannot connect to SharePoint site $web...&quot; 
}   
# Ensure page name ends with .aspx 
if (!$pageName.EndsWith(&quot;.aspx&quot;)) {     
  $pageName = $(&quot;$pageName.aspx&quot;) 
}  

try {     
  # Check if the page already exists     
  Write-Host &quot;Checking if $pageName already exists...&quot; -ForegroundColor Yellow     
  $page = Get-PnPClientSidePage -Identity $pageName -ErrorAction Ignore     
  If ($null -eq $page) {         
    # If the page does not exist, create it         
    Write-Host &quot;Creating page $pageName...&quot; -ForegroundColor Cyan         
    $page = Add-PnPClientSidePage -Name $pageName         
    Write-Host &quot;Page $pageName has been successfully created.&quot; -ForegroundColor Green     
  } Else {         
    Write-Host &quot;Page $pageName does exist.&quot; -ForegroundColor Green     
  } 
} catch {     
  throw &quot;Page cannot be found and could not be created.&quot; 
}   

# Try to get the component from available components 
$appComponent = Get-PnPAvailableClientSideComponents -Page $page -Component $appName 
If ($null -eq $appComponent) {     
  Throw &quot;The component $appName could not be found in the tenant. Please install it first&quot; 
}  

# Ensure the app configuration if not specified 
if ($null -eq $appConfig) {     
  $appConfig = @{ }; 
}  

try {     
  Write-Host &quot;Adding client side component $appName to page...&quot; -ForegroundColor Yellow     
  # Add the component (WebPart) to the page     
  Add-PnPClientSideWebPart -Page $page -Component $appComponent -WebPartProperties $appConfig -OutVariable $addWpOut     
  Write-Host &quot;Client side component successfully added.&quot; -ForegroundColor Green 
} catch {     
  throw &quot;Client side component could not be added to page...&quot; 
}   

try {     
  Write-Host &quot;Removing Edit permissions from application page for members...&quot; -ForegroundColor Yellow     
  # Set the edit permissions for the app page only for owners (Set read only for members)     
  $members = Get-PnPGroup -AssociatedMemberGroup     
  $appPageListItem = Get-PnPListItem -List &quot;Site Pages&quot;  -Query &quot;&lt;View&gt;&lt;Query&gt;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name='FileLeafRef'/&gt;&lt;Value Type='Text'&gt;$pageName&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&lt;/Query&gt;&lt;/View&gt;&quot;     
  Set-PnPListItemPermission -List &quot;Site Pages&quot; -Identity $appPageListItem.Id -Group $members -RemoveRole Edit -AddRole Read -OutVariable $setPageOut     
  Write-Host &quot;Permissions successfully applied to application page&quot; -ForegroundColor Green 
} catch {     
  throw &quot;Cannot change permissions for application page...&quot; 
}  

try {     
  Write-Host &quot;Changing page layout type to single WebPart app page and publishing...&quot; -ForegroundColor Yellow     
  # Publish the page and change the layout to Single WebPart App page     
  Set-PnPClientSidePage -Identity $page -LayoutType SingleWebPartAppPage -Publish -OutVariable $publishedOut     
  Write-Host &quot;Layout successfully changed and page successfully published&quot; -ForegroundColor Green 
} catch {     
  throw &quot;The application page could not be published...&quot; }  
  Write-Host &quot;Corporate single page application has been deployed to $web&quot; -ForegroundColor Green
}
</code></pre>
<p><img src="/images/2019/09/scriptexec.png" alt="scriptexec.png" /></p>
<p>The owners of the site will see</p>
<p><img src="/images/2019/09/spa_edit.png" alt="spa_edit.png" /></p>
<p>While any other users will see</p>
<p><img src="/images/2019/09/spa_read.png" alt="spa_read.png" /></p>
<h1 id="conclusion">Conclusion</h1>
<p>As usual, PnP PowerShell helps us here and we have a quite simple solution. However, I would have preferred a more straightforward procedure for achieving this, The flag in the supportedHosts is great, but, IMHO, it is still not sufficient for us, developers and solutions providers to seamlessly install corporate applications, if, by default, end-users can interfere with it. I hope you found this post useful, and please, let me know any feedback you might have on this !</p>
<p>Cheers!</p>
<p>Yannick</p>

    </div>

    <div class="foot-random-posts">
        <div class="random-posts-container">
<h5>Other posts</h5>
<div id="random-posts" class="posts d-flex flex-wrap align-content-stretch">
</div>

<script>
    WCG.execute((db) => {

        const renderCard = (placeholderSelector, item) => {
            const placeholder = $(placeholderSelector);
            $(`<div class="post-card card box-shadow">
                <a href="${item.RelativeUrl}">
                    <img class="post-featured-image card-img-top" src="${item.FeaturedImage}" alt="${item.FeaturedImageAlt}" />
                </a>
                <div class="post-caption card-body">
                    <h5 class="post-title card-title">
                        <a href="${item.RelativeUrl}">${item.Title}</a>
                    </h5>
                    <span class="post-publishing-date">${moment(item.PublishedOn).format("MMM DD, YYYY")}</span>
                    <p class="post-summary card-text">
                        ${item.Description||''}
                    </p>
                    <div class="post-keywords">
                        ${item.Keywords.map(k => `<span class="post-keyword">#${k.replace(" ","")}</span>`).join(" ")}
                    </div>
                </div>
            </div>
            `).appendTo(placeholder);
        };

        const [firstPost, secondPost] = db.getRandomPosts(2);
        renderCard("#random-posts", firstPost);
        renderCard("#random-posts", secondPost);
    });
</script>
</div>
    </div>

     <div class="post-comments">
            <div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://ypcode.io/posts/2019/09/deploy-corporate-spfx-app-pages';
this.page.identifier = 'src\content\posts\2019-09-23-deploy-corporate-spfx-app-pages.md';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://ypcode-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
</div>
        </main>

        <footer class="border-top footer">
                &copy; Copyrights 2020 - YPcode - Yannick Plenevaux
        </footer>
    </div>

    <script src="/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/site.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" ></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.js" ></script>

        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-aspnet.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-c.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-clike.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-csharp.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-css-extras.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-scss.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-markup.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-javascript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-jsx.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-powershell.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-typescript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.js" ></script>



</body>
</html>
