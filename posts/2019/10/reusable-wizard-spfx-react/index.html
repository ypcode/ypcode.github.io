<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>YPcode</title>
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://ypcode.io/posts/2019/10/reusable-wizard-spfx-react" />
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css?v=202007180230" />
    <meta name="generator" content="PVX WebContentGenerator" />
    <script src="/lib/jquery/dist/jquery.min.js"></script>
    <script src="/js/framework.js?v=202007180230"></script>
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css">
</noscript>
<style>
pre[class*=language-] {    
    margin-bottom: 1.5em;
}
</style>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172372458-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172372458-1');
</script>

<style>
.social-links {
    display: inline-flex;
    width: 60%;
    margin:auto;
    justify-content: center;
    color: #807070;
}

.social-links a {
    margin-right: 15px;
}

.social-links a:hover {
    color: #9e1e28;
}

    .social-links svg {
        fill: currentColor;
        height: 18px;
    }
</style>
        <meta property="og:site_name" content="YPcode" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="Build a reusable Wizard component for your SPFx solutions using React and Office UI Fabric" />
            <meta property="og:description" content="I built a base component that I share with you so you can customize it easily to have your own Wizard in your SPFx applications" />
        <meta property="og:url" content="https://ypcode.io/posts/2019/10/reusable-wizard-spfx-react" />
        <meta property="og:image" content="/images/2019/10/wizard.png?r=202007180230" />
        <meta property="article:publisher" content="https://www.facebook.com/yannick.plenevaux" />
        <meta property="article:published_time" content="2019-10-31 14:29:20Z" />
        <meta property="article:modified_time" content="2019-10-31 14:29:20Z" />
                <meta property="article:tag" content="JavaScript" />
                <meta property="article:tag" content="JS" />
                <meta property="article:tag" content="Office 365" />
                <meta property="article:tag" content="Office UI Fabric" />
                <meta property="article:tag" content="SharePoint" />
                <meta property="article:tag" content="SharePoint Framework" />
                <meta property="article:tag" content="SharePoint Online" />
                <meta property="article:tag" content="SPFx" />
                <meta property="article:tag" content="TypeScript" />
                <meta property="article:tag" content="Web Development" />
        <meta name="twitter:title" content="Build a reusable Wizard component for your SPFx solutions using React and Office UI Fabric" />
            <meta name="twitter:description" content="I built a base component that I share with you so you can customize it easily to have your own Wizard in your SPFx applications" />
        <meta name="twitter:url" content="https://ypcode.io/posts/2019/10/reusable-wizard-spfx-react" />
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:image" content="/images/2019/10/wizard.png?r=202007180230" />
            <meta name="twitter:label1" content="Written by" />
            <meta name="twitter:data1" content="Yannick Plenevaux" />
            <meta name="twitter:label2" content="Filed under" />
            <meta name="twitter:data2" content="JavaScript, JS, Office 365, Office UI Fabric, SharePoint, SharePoint Framework, SharePoint Online, SPFx, TypeScript, Web Development" />
        <meta name="twitter:site" content="@yp_code" />
    <link rel="alternate" type="application/rss+xml" title="YPcode" href="https://ypcode.io/feed" />


    <script>
        var initialSiteContentHeight = null;
        function toggleMenu() {
            var menu = document.querySelector(".menu");
            var siteContent = document.querySelector(".site-content");
            if (menu && siteContent) {
                if (menu.classList.contains("visible")) {
                    menu.classList.remove("visible");
                } else {
                    menu.classList.add("visible");
                }
            }
        }
    </script>
</head>
<body>
    <div class="menu">
        <span class="menu-hamburger-icon" onclick="toggleMenu();">
            <svg xmlns="http://www.w3.org/2000/svg" 
                x="0px" 
                y="0px"
                width="30" 
                height="30"
                viewBox="0 0 172 172"
                style=" fill:#000000;">
                    <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M0,25.8v17.2h172v-17.2zM0,77.4v17.2h172v-17.2zM0,129v17.2h172v-17.2z"></path></g></g>
            </svg>
        </span>
        <a href="https://ypcode.io/">
            <h1 class="main-site-title">YPcode</h1>
            <hr class="sep main-site-title-sep"/>
            <h2 class="main-site-description">Experiences and research on Microsoft 365, Azure and modern web development</h2>
        </a>
        <nav class="navigation">
    <ul>
<li class="nav-item">
    <span class="link-icon icon-home" ></span><a class="nav-link" href="/" >Home</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/about-me/" >About me</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/projects-contrib/" >Projects &amp; Contributions</a>
</li>    </ul>
</nav>
        
            <div class="main-site-author">
                    <img class="main-site-author-picture" src="/images/common/me.png" />
                    <h3 class="main-site-author-name">
                        Yannick Plenevaux
                    </h3>
                        <h3 class="main-site-author-description">
                                <span class="main-site-author-description-line">Microsoft 365 Solutions Architect</span>
                                <span class="main-site-author-description-line">Office Development MVP</span>
                        </h3>
            </div>

        <div class="menu-social-links">
            <p class="social-links">

    <a href="https://mvp.microsoft.com/en-us/PublicProfile/5003599?fullName=Yannick%20Plenevaux" target="_blank"
        title="Microsoft MVP" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
            <defs>
                <style>
                    .a {
                        fill: currentColor;
                    }

                    .b {
                        fill: #1d1d1d;
                    }
                </style>
            </defs>
            <rect class="a" width="50" height="50"></rect>
            <path class="b"
                d="M17.42,26.16a15.14,15.14,0,0,0-.22,1.59l-.07.48h0a14.16,14.16,0,0,0-.33-2l-1.82-7.89h-3.5v13h2.07V24.43c0-1.18,0-2.39-.09-3.61h.08l.35,2.3,2,8.19h2.28L20,23c.18-.9.31-1.63.39-2.18h.05q-.09,2-.09,2.94v7.55h2.14v-13H19.13Zm18.36.72h1a3.81,3.81,0,0,0,3-1.24,4.54,4.54,0,0,0,1.14-3.17,4.23,4.23,0,0,0-1-3.08A3.81,3.81,0,0,0,37,18.34H33.29v13h2.49Zm0-6.37h.83a1.62,1.62,0,0,1,1.25.52,2.25,2.25,0,0,1,.48,1.57c0,1.42-.57,2.13-1.7,2.13h-.86Zm-9.24,10.8h2.67l3.31-13H30l-1.8,8.5c-.09.47-.15.92-.19,1.34l-.05.35h-.06a12,12,0,0,0-.2-1.65l-1.8-8.54H23.32ZM25.26,46.75,3.75,25.24,25.24,3.75,46.75,25.26Z"
                transform="translate(-0.25 -0.25)"></path>
        </svg>
        </a>

    <a href="https://twitter.com/yp_code" target="_blank" title="Twitter" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
            </path>
        </svg>
    </a>

    <a href="https://github.com/ypcode" target="_blank" title="GitHub" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path
                d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
        </svg>
    </a>

    <a href="https://www.linkedin.com/in/yannickplenevaux" target="_blank" title="LinkedIn" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
            <path
                d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z">
            </path>
        </svg>
    </a>


</p>
        </div>
    </div>
   
    <div class="site-content">
        <main role="main" class="pb-3">
            <div class="content-item post">
    
    <div class="content-item-title">
        <span class="post-publishing-date">Oct 31, 2019</span>
        <h1>
            Build a reusable Wizard component for your SPFx solutions using React and Office UI Fabric
            <hr/>
        </h1>
    </div>

        <div class="content-item-featured-image-container">
            <img class="content-item-featured-image" src="/images/2019/10/wizard.png?r=202007180230" alt="Build a reusable Wizard component for your SPFx solutions using React and Office UI Fabric" />
        </div>
   
    <div class="content">
        <p>Hi SharePoint guys,</p>
<p>Today, I am going to show and share how we can build a reusable and flexible wizard component we will be able to use in our SPFx solutions ! Actually, it is a component that can be used in any React application but I'll show it using a SPFx solution since all the boilerplate is already in there (moreover my intent was to use it in SPFx solution so... :D)</p>
<h2 id="the-purpose">The purpose</h2>
<p>As in many applications, we might need to guide our users through steps in order to fill in information in a consistent way, the solution I am going to demonstrate here is a way to have a generic component that will take care of the Wizard behavior instead of rewriting it each time we need something similar. In this blog post, I am going to share the whole code and demonstrate the logic and how to use it.</p>
<h2 id="the-implementation">The implementation</h2>
<p>The component is implemented in a reeeally simple way with only a few &quot;navigation&quot; buttons, and a Office UI Fabric Pivot component. And, IMHO, it looks quite good and integrates smoothly with Microsoft UI trends. So we need the following:</p>
<ul>
<li>A Pivot component that will render the pages (steps) of our wizard</li>
<li>A &quot;Previous&quot; button if there is an available previous step</li>
<li>A &quot;Next&quot; button if there is an available next step</li>
<li>A &quot;Cancel&quot; button always visible</li>
<li>A &quot;Finish&quot; button if we are at the last step of the wizard.</li>
</ul>
<h3 id="enum-flags">Enum flags</h3>
<p>We need to provide a list of individual steps and identify them uniquely. In order to simplify the logic and try to make it as generic as it can be, I'll use a TypeScript enum flags, it is a concept I used a lot in C#, and when suitable, I use it in TypeScript as well, we declare an enum and set the numeric value of each enum member as a binary single bit mask value</p>
<p><img src="/images/2019/10/enum_flags.png" alt="enum_flags" /></p>
<p>We could have written in the following form to emphasize the used binary bits</p>
<p><img src="/images/2019/10/enum_flags_binary.png" alt="enum_flags_binary" />        </p>
<p>Notice the &quot;None&quot; value set to 0, that value will never be used, and a Wizard step cannot be identified by 0, because the bitwise operators (bit shifts) won't work with all 0s :)</p>
<h2 id="show-me-the-code">Show me the code !</h2>
<p>In order to have a component easy to reuse and have intellisense in VS Code, I chose to write an abstract component with a generic parameter that will hold the type our steps enum. You can take the code of this abstract component as is and put it somewhere in your solution, unless you need to improve it or adapt it, you would probably not need to change this code.
However, feel free to take a look at the code to see how the bitwise operators are helping here :)</p>
<p>For instance, you can put the following code in a <strong>components/</strong> folder under your SPFx <strong>src/</strong> folder in a file <strong>Wizard.tsx</strong></p>
<pre><code class="language-typescript">import * as React from &quot;react&quot;;
import { ActionButton } from &quot;office-ui-fabric-react/lib/Button&quot;;
import { Pivot, PivotItem, IPivotItemProps } from &quot;office-ui-fabric-react/lib/Pivot&quot;;
import styles from &quot;./Wizard.module.scss&quot;;

export interface IWizardStepProps&lt;TStep extends number&gt; extends IPivotItemProps {
    step: TStep;
    caption: string;
}

export class WizardStep&lt;TStep extends number&gt; extends React.Component&lt;IWizardStepProps&lt;TStep&gt;, {}&gt; {

}

export interface IWizardStepValidationResult {
    isValidStep: boolean;
    errorMessage?: string;
}

export interface IWizardProps&lt;TStep extends number&gt; {
    defaultCurrentStep?: TStep;
    onValidateStep?: (currentStep: TStep) =&gt; IWizardStepValidationResult | Promise&lt;IWizardStepValidationResult&gt;;
    onCompleted?: () =&gt; void;
    onCancel?: () =&gt; void;
    nextButtonLabel?: string;
    previousButtonLabel?: string;
    cancelButtonLabel?: string;
    finishButtonLabel?: string;
    validatingMessage?: string;
    mainCaption?: string;
}

export interface IWizardState&lt;TStep extends number&gt; {
    currentStep: TStep;
    completedSteps: TStep;
    errorMessage: string;
    isValidatingStep: boolean;
}

const DEFAULT_NEXT_BUTTON_LABEL = &quot;Next&quot;;
const DEFAULT_PREVIOUS_BUTTON_LABEL = &quot;Previous&quot;;
const DEFAULT_FINISH_BUTTON_LABEL = &quot;Finish&quot;;
const DEFAULT_CANCEL_BUTTON_LABEL = &quot;Cancel&quot;;
const DEFAULT_VALIDATING_MESSAGE = &quot;Validating step...&quot;;

export abstract class BaseWizard&lt;TStep extends number&gt; extends React.Component&lt;IWizardProps&lt;TStep&gt;, IWizardState&lt;TStep&gt;&gt; {

    constructor(props: IWizardProps&lt;TStep&gt;) {
        super(props);

        this.state = {
            currentStep: props.defaultCurrentStep || this.firstStep,
            completedSteps: null,
            errorMessage: null,
            isValidatingStep: false
        };
    }

    private renderSteps() {
        const stepChildren = React.Children.toArray(this.props.children)
            .filter((reactChild: React.ReactElement) =&gt; reactChild.type == WizardStep &amp;&amp; reactChild.props.step);

        if (stepChildren.length == 0) {
            throw new Error(&quot;The specified wizard steps are not valid&quot;);
        }

        return stepChildren
            .map((reactChild: React.ReactElement) =&gt; {
                return &lt;PivotItem key={`WizardStep__${reactChild.props.step}`}
                    itemKey={reactChild.props.step.toString()}
                    headerText={reactChild.props.caption}
                    headerButtonProps={{}} &gt;
                    {reactChild.props.children}
                &lt;/PivotItem&gt;;
            });
    }

    private get firstStep(): TStep {
        const stepValues = React.Children.toArray(this.props.children)
            .filter((c: React.ReactElement) =&gt; c.props.step as number &gt; 0)
            .map((c: React.ReactElement) =&gt; c.props.step as number);
        if (stepValues.length &lt; 1) {
            throw new Error(&quot;The specified step values are invalid. First step value must be higher than 0&quot;);
        }
        return Math.min(...stepValues) as TStep;
    }

    private get lastStep(): TStep {
        const stepValues = React.Children.toArray(this.props.children)
            .filter((c: React.ReactElement) =&gt; c.props.step as number &gt; 0)
            .map((c: React.ReactElement) =&gt; c.props.step as number);
        if (stepValues.length &lt; 1) {
            throw new Error(&quot;The specified step values are invalid. First step value must be higher than 0&quot;);
        }
        return Math.max(...stepValues) as TStep;
    }

    private _validateWithCallback = (validationCallback: (validationResult: IWizardStepValidationResult) =&gt; void) =&gt; {

        if (!validationCallback) {
            return;
        }

        const validationResult = this._validateStep(this.state.currentStep);
        if (typeof (validationResult as Promise&lt;IWizardStepValidationResult&gt;).then === &quot;function&quot;) {
            this.setState({
                isValidatingStep: true,
                errorMessage: null
            });
            const promiseResult = validationResult as Promise&lt;IWizardStepValidationResult&gt;;
            promiseResult.then(result =&gt; {
                validationCallback(result);
            }).catch(error =&gt; {
                if (error as string) {
                    validationCallback({
                        isValidStep: false,
                        errorMessage: error
                    });
                }
            });
        }
        else {
            const directResult = validationResult as IWizardStepValidationResult;
            if (!directResult) {
                throw new Error(&quot;The validation result has unexpected format.&quot;);
            }
            validationCallback(directResult);
        }
    }

    private _goToStep = (step: TStep, completedSteps?: TStep, skipValidation: boolean = false) =&gt; {

        if (!skipValidation) {
            this._validateWithCallback(result =&gt; {
                if (result.isValidStep) {

                    this.setState({
                        currentStep: step,
                        completedSteps,
                        errorMessage: null,
                        isValidatingStep: false
                    });
                } else {
                    this.setState({
                        errorMessage: result.errorMessage,
                        isValidatingStep: false
                    });
                }
            });
        } else {
            this.setState({ currentStep: step, completedSteps });
        }
    }

    private _validateStep = (step: TStep) =&gt; {
        if (this.props.onValidateStep) {
            return this.props.onValidateStep(step);
        }

        return {
            isValidStep: true,
            errorMessage: null
        };
    }

    private get hasNextStep(): boolean {
        return this.state.currentStep &lt; this.lastStep;
    }

    private get hasPreviousStep(): boolean {
        return this.state.currentStep &gt; this.firstStep;
    }

    private _goToNextStep = () =&gt; {
        let completedWizardSteps = (this.state.completedSteps | this.state.currentStep) as TStep;
        const nextStep = ((this.state.currentStep as number) &lt;&lt; 1) as TStep;
        console.log(&quot;Current step: &quot;, this.state.currentStep, &quot; next step: &quot;, nextStep);
        this._goToStep(nextStep, completedWizardSteps);
    }

    private _goToPreviousStep = () =&gt; {
        const previousStep = ((this.state.currentStep as number) &gt;&gt; 1) as TStep;
        console.log(&quot;Current step: &quot;, this.state.currentStep, &quot; previous step: &quot;, previousStep);
        this._goToStep(previousStep, null, true);
    }


    private _cancel = () =&gt; {
        if (this.props.onCancel) {
            this.props.onCancel();
        }
    }

    private _finish = () =&gt; {
        this._validateWithCallback((result) =&gt; {
            if (result.isValidStep) {
                if (this.props.onCompleted) {
                    this.props.onCompleted();
                }
            } else {
                this.setState({
                    errorMessage: result.errorMessage,
                    isValidatingStep: false
                });
            }
        });
    }

    private get cancelButton(): JSX.Element {
        return &lt;ActionButton iconProps={{ iconName: &quot;Cancel&quot; }} text={this.props.cancelButtonLabel || DEFAULT_CANCEL_BUTTON_LABEL} onClick={this._cancel} /&gt;;
    }

    private get previousButton(): JSX.Element {
        if (this.hasPreviousStep) {
            return &lt;ActionButton iconProps={{ iconName: &quot;ChevronLeft&quot; }} text={this.props.previousButtonLabel || DEFAULT_PREVIOUS_BUTTON_LABEL} onClick={this._goToPreviousStep} /&gt;;
        }

        return null;
    }

    private get nextButton(): JSX.Element {
        if (this.hasNextStep) {
            return &lt;ActionButton iconProps={{ iconName: &quot;ChevronRight&quot; }} text={this.props.nextButtonLabel || DEFAULT_NEXT_BUTTON_LABEL} onClick={this._goToNextStep} /&gt;;
        }

        return null;
    }

    private get finishButton(): JSX.Element {
        if (!this.hasNextStep) {
            return &lt;ActionButton iconProps={{ iconName: &quot;Save&quot; }} text={this.props.finishButtonLabel || DEFAULT_FINISH_BUTTON_LABEL} onClick={this._finish} /&gt;;
        }

        return null;
    }

    public render(): React.ReactElement&lt;IWizardProps&lt;TStep&gt;&gt; {
        return &lt;div className={styles.wizardComponent}&gt;
            {this.props.mainCaption &amp;&amp; &lt;h1&gt;{this.props.mainCaption}&lt;/h1&gt;}
            &lt;Pivot selectedKey={this.state.currentStep.toString()}&gt;
                {this.renderSteps()}
            &lt;/Pivot&gt;
            {this.state.isValidatingStep &amp;&amp; &lt;div&gt;{this.props.validatingMessage || DEFAULT_VALIDATING_MESSAGE}&lt;/div&gt;}
            {this.state.errorMessage &amp;&amp; &lt;div className={styles.error}&gt;{this.state.errorMessage}&lt;/div&gt;}

            &lt;div className={styles.row}&gt;
                &lt;div className={`${styles.halfColumn} ${styles.lefted}`}&gt;
                    {this.cancelButton}
                &lt;/div&gt;
                &lt;div className={`${styles.halfColumn} ${styles.righted}`}&gt;
                    {this.previousButton}
                    {this.nextButton}
                    {this.finishButton}
                &lt;/div&gt;
            &lt;/div&gt;


        &lt;/div&gt;;
    }
}
</code></pre>
<p>Along that TSX file, you will probably need a bit of css to make it look a bit (just a bit) nicer.</p>
<p>Add that <strong>Wizard.module.scss</strong> file</p>
<pre><code class="language-scss">@import '~@microsoft/sp-office-ui-fabric-core/dist/sass/SPFabricCore.scss';

.wizardComponent {
  
  .row {
    @include ms-Grid-row;
    padding: 20px;
  }

  .column {
    @include ms-Grid-col;
    @include ms-sm12;
  }

  .halfColumn {
    @include ms-Grid-col;
    @include ms-sm6;
  }

  .fullWidthColumn {
    @include ms-Grid-col;
    @include ms-sm12;
  }

  .title {
    @include ms-font-xl;
    @include ms-fontColor-white;
  }

  .subTitle {
    @include ms-font-l;
    @include ms-fontColor-white;
  }

  .description {
    @include ms-font-l;
    @include ms-fontColor-white;
  }

  .lefted {
    text-align: left;
  }

  .righted {
    text-align: right;
  }

  .error {
    margin: 20px;
    padding: 15px;
    font-size: larger;
    font-weight: bold;
    background-color: $ms-color-red;
    color: $ms-color-white;
  }

  .button {
    // Our button
    text-decoration: none;
    height: 32px;

    // Primary Button
    min-width: 80px;
    background-color: $ms-color-themePrimary;
    border-color: $ms-color-themePrimary;
    color: $ms-color-white;

    // Basic Button
    outline: transparent;
    position: relative;
    font-family: &quot;Segoe UI WestEuropean&quot;,&quot;Segoe UI&quot;,-apple-system,BlinkMacSystemFont,Roboto,&quot;Helvetica Neue&quot;,sans-serif;
    -webkit-font-smoothing: antialiased;
    font-size: $ms-font-size-m;
    font-weight: $ms-font-weight-regular;
    border-width: 0;
    text-align: center;
    cursor: pointer;
    display: inline-block;
    padding: 0 16px;

    .label {
      font-weight: $ms-font-weight-semibold;
      font-size: $ms-font-size-m;
      height: 32px;
      line-height: 32px;
      margin: 0 4px;
      vertical-align: top;
      display: inline-block;
    }
  }
}
</code></pre>
<p>With these pieces of code in your solution, you are ready now to use your own Wizard !
in your SPFx React component, you need to do the following, declare the steps with one shifted bit for each step, and then declare a new
React component extending the BaseWizard with your own enum</p>
<pre><code class="language-typescript">//...
export enum MyWizardSteps {
  None        = 0b0000,
  FirstStep   = 0b0001,
  SecondStep  = 0b0010,
  ThirdStep   = 0b0100,
  LastStep    = 0b1000
}

export class MyWizard extends BaseWizard&lt;MyWizardSteps&gt; {}
//...
</code></pre>
<p>In the render method of your host React component you can then write the following, building all your step within a WizardStep element with the step property set to its step identifier, if the step is not specified, an error will be raised while rendering...</p>
<pre><code class="language-typescript">import { BaseWizard, WizardStep, IWizardStepValidationResult } from &quot;../../../common/components/Wizard&quot;;
//...


 private _closeWizard(completed: boolean = false) {
   this.setState({
     isWizardOpened: false,
     statusMessage: completed ? &quot;The wizard has been completed&quot; : &quot;The wizard has been canceled&quot;,
     statusType: completed ? &quot;OK&quot; : &quot;KO&quot;
   });

   setTimeout(() =&gt; {
     this.setState({
       statusMessage: null,
       statusType: null
     });
   }, 3000);
 }

 private _onValidateStep(step: MyWizardSteps): IWizardStepValidationResult | Promise&lt;IWizardStepValidationResult&gt; {

   let isValid = true;
   switch (step) {
     case MyWizardSteps.FirstStep:
       isValid = this.state.firstStepInput == 'first';
       return {
         isValidStep: isValid,
         errorMessage: !isValid ? &quot;Your input to first step is invalid&quot; : null
       };
     case MyWizardSteps.ThirdStep:

       return new Promise((resolve) =&gt; {
         isValid = this.state.thirdStepInput == 'third';
         setTimeout(() =&gt; {
           resolve({
             isValidStep: isValid,
             errorMessage: !isValid ? &quot;Your input to third step is invalid&quot; : null
           });
         }, 3000);
       });
     case MyWizardSteps.LastStep:
       this.setState({
         wizardValidatingMessage: 'Validating all the information you entered...'
       });
       return new Promise((resolve) =&gt; {
         isValid = this.state.thirdStepInput == 'third';
         setTimeout(() =&gt; {
           resolve({
             isValidStep: isValid,
             errorMessage: !isValid ? &quot;One of your input is invalid&quot; : null
           });
           this.setState({
             wizardValidatingMessage: null
           });
         }, 3000);
       });
     default:
       return { isValidStep: true };
   }
 }


 private _renderMyWizard() {

   return &lt;MyWizard
     mainCaption=&quot;My Wizard&quot;
     onCancel={() =&gt; this._closeWizard(false)}
     onCompleted={() =&gt; this._closeWizard(true)}
     onValidateStep={(step) =&gt; this._onValidateStep(step)}
     validatingMessage={this.state.wizardValidatingMessage}
   &gt;
     &lt;WizardStep caption=&quot;My first step&quot; step={MyWizardSteps.FirstStep}&gt;
       &lt;div className={styles.wizardStep}&gt;
         &lt;h1&gt;Hello from first step&lt;/h1&gt;
         &lt;TextField
           value={this.state.firstStepInput}
           placeholder=&quot;Type 'first' to validate the step&quot;
           onChanged={(v) =&gt; this.setState({ firstStepInput: v })}&gt;&lt;/TextField&gt;
       &lt;/div&gt;
     &lt;/WizardStep&gt;

     &lt;WizardStep caption=&quot;My second step&quot; step={MyWizardSteps.SecondStep}&gt;
       &lt;div className={styles.wizardStep}&gt;
         &lt;h1&gt;Hello from second step&lt;/h1&gt;
       &lt;/div&gt;
     &lt;/WizardStep&gt;

     &lt;WizardStep caption=&quot;My third step&quot; step={MyWizardSteps.ThirdStep}&gt;
       &lt;div className={styles.wizardStep}&gt;
         &lt;h1&gt;Hello from third step&lt;/h1&gt;
         &lt;TextField
           value={this.state.thirdStepInput}
           placeholder=&quot;Type 'third' to validate the step (async validation)&quot;
           onChanged={(v) =&gt; this.setState({ thirdStepInput: v })}&gt;&lt;/TextField&gt;
       &lt;/div&gt;
     &lt;/WizardStep&gt;

     &lt;WizardStep caption=&quot;My final step&quot; step={MyWizardSteps.LastStep}&gt;
       &lt;div className={styles.wizardStep}&gt;
         &lt;h1&gt;Hello from final step&lt;/h1&gt;
       &lt;/div&gt;
     &lt;/WizardStep&gt;
   &lt;/MyWizard&gt;;
 }
</code></pre>
<p>You'll probably have noticed the <em><strong>onValidateStep</strong></em> callback property that can either return the validation result directly or a promise resolving the validation result, it will allow to handle async calls during validation.</p>
<p>See the below animation to have an idea of what that component will allow you to do.</p>
<p><img src="/images/2019/10/demo01.gif" alt="demo01" /></p>
<p>Hopefully, you'll find this little reusable component useful!
You can find the whole solution on the <a href="https://github.com/ypcode/ypcode-spfx-samples/tree/master/spfx-wizard-component">Github repo here</a>.</p>
<p>At the moment, it is not shipped it as a ready to use component, but feel free to do so :)
Also, if you have any idea of improvement or notice some issue, please, notify me on the Github repo !</p>
<p>Cheers !</p>
<p>Yannick</p>

    </div>

    <div class="foot-random-posts">
        <div class="random-posts-container">
<h5>Other posts</h5>
<div id="random-posts" class="posts d-flex flex-wrap align-content-stretch">
</div>

<script>
    WCG.execute((db) => {

        const renderCard = (placeholderSelector, item) => {
            const placeholder = $(placeholderSelector);
            $(`<div class="post-card card box-shadow">
                <a href="${item.RelativeUrl}">
                    <img class="post-featured-image card-img-top" src="${item.FeaturedImage}" alt="${item.FeaturedImageAlt}" />
                </a>
                <div class="post-caption card-body">
                    <h5 class="post-title card-title">
                        <a href="${item.RelativeUrl}">${item.Title}</a>
                    </h5>
                    <span class="post-publishing-date">${item.PublishedOn}</span>
                    <p class="post-summary card-text">
                        ${item.Description||''}
                    </p>
                    <div class="post-keywords">
                        ${item.Keywords.map(k => `<span class="post-keyword">#${k.replace(" ","")}</span>`).join(" ")}
                    </div>
                </div>
            </div>
            `).appendTo(placeholder);
        };

        const [firstPost, secondPost] = db.getRandomPosts(2);
        renderCard("#random-posts", firstPost);
        renderCard("#random-posts", secondPost);
    });
</script>
</div>
    </div>

     <div class="post-comments">
            <div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://ypcode.io/posts/2019/10/reusable-wizard-spfx-react';
this.page.identifier = 'src\content\posts\2019-10-31-build-a-reusable-wizard-component-for-your-spfx-solutions-using-react-and-office-ui-fabric.md';
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://ypcode-io.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
</div>
        </main>

        <footer class="border-top footer">
                &copy; Copyrights 2020 - YPcode - Yannick Plenevaux
        </footer>
    </div>

    <script src="/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/site.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" ></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.js" ></script>

        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-aspnet.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-c.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-clike.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-csharp.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-css-extras.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-scss.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-markup.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-javascript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-jsx.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-powershell.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-typescript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.js" ></script>



</body>
</html>
