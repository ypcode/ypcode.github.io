<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>YPcode</title>
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <link rel="canonical" href="https://ypcode.github.io/posts/2016/11/easily-extend-sharepoint-open-newtab-pnp-js-powershell" />
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/site.css" />
    <meta name="generator" content="PVX WebContentGenerator" />
   
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css">
</noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.css">
</noscript>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172372458-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172372458-1');
</script>

<style>
.social-links {
    display: inline-flex;
    width: 60%;
    margin:auto;
    justify-content: center;
    color: #807070;
}

.social-links a {
    margin-right: 15px;
}

.social-links a:hover {
    color: #9e1e28;
}

    .social-links svg {
        fill: currentColor;
        height: 18px;
    }
</style>
        <meta property="og:site_name" content="YPcode" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="Easily extend SharePoint - "Open in a new tab" with JS & PnP PowerShell" />
        <meta property="og:url" content="https://ypcode.github.io/posts/2016/11/easily-extend-sharepoint-open-newtab-pnp-js-powershell" />
        <meta property="og:image" content="/images/common/js.png?r=202007151244" />
        <meta property="article:publisher" content="https://www.facebook.com/yannick.plenevaux" />
        <meta property="article:published_time" content="2016-11-30 22:43:08Z" />
        <meta property="article:modified_time" content="2016-11-30 22:43:08Z" />
                <meta property="article:tag" content="JS" />
                <meta property="article:tag" content="PnP" />
                <meta property="article:tag" content="Remote Provisionning" />
                <meta property="article:tag" content="SharePoint" />
        <meta name="twitter:title" content="Easily extend SharePoint - "Open in a new tab" with JS & PnP PowerShell" />
        <meta name="twitter:url" content="https://ypcode.github.io/posts/2016/11/easily-extend-sharepoint-open-newtab-pnp-js-powershell" />
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:image" content="/images/common/js.png?r=202007151244" />
            <meta name="twitter:label2" content="Filed under" />
            <meta name="twitter:data2" content="JS, PnP, Remote Provisionning, SharePoint" />
        <meta name="twitter:site" content="@yp_code" />
    <link rel="alternate" type="application/rss+xml" title="YPcode" href="https://ypcode.github.io/feed" />


    <script>
        var initialSiteContentHeight = null;
        function toggleMenu() {
            var menu = document.querySelector(".menu");
            var siteContent = document.querySelector(".site-content");
            if (menu && siteContent) {
                if (menu.classList.contains("visible")) {
                    menu.classList.remove("visible");
                } else {
                    menu.classList.add("visible");
                }
            }
        }
    </script>
</head>
<body>
    <div class="menu">
        <span class="menu-hamburger-icon" onclick="toggleMenu();">
            <svg xmlns="http://www.w3.org/2000/svg" 
                x="0px" 
                y="0px"
                width="30" 
                height="30"
                viewBox="0 0 172 172"
                style=" fill:#000000;">
                    <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M0,25.8v17.2h172v-17.2zM0,77.4v17.2h172v-17.2zM0,129v17.2h172v-17.2z"></path></g></g>
            </svg>
        </span>
        <a href="https://ypcode.github.io/">
            <h1 class="main-site-title">YPcode</h1>
            <hr class="sep main-site-title-sep"/>
            <h2 class="main-site-description">Experiences and research on Microsoft 365, Azure and modern web development</h2>
        </a>
        <nav class="navigation">
    <ul>
<li class="nav-item">
    <span class="link-icon icon-home" ></span><a class="nav-link" href="/" >Home</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/about-me/" >About me</a>
</li><li class="nav-item">
    <span class="link-icon icon-about" ></span><a class="nav-link" href="/pages/projects-contrib/" >Projects &amp; Contributions</a>
</li>    </ul>
</nav>
        
            <div class="main-site-author">
                    <img class="main-site-author-picture" src="/images/me.png" />
                    <h3 class="main-site-author-name">
                        Yannick Plenevaux
                    </h3>
                        <h3 class="main-site-author-description">
                                <span class="main-site-author-description-line">Microsoft 365 Solutions Architect</span>
                                <span class="main-site-author-description-line">Office Development MVP</span>
                        </h3>
            </div>

        <div class="menu-social-links">
            <p class="social-links">

    <a href="https://mvp.microsoft.com/en-us/PublicProfile/5003599?fullName=Yannick%20Plenevaux" target="_blank"
        title="Microsoft MVP" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
            <defs>
                <style>
                    .a {
                        fill: currentColor;
                    }

                    .b {
                        fill: #1d1d1d;
                    }
                </style>
            </defs>
            <rect class="a" width="50" height="50"></rect>
            <path class="b"
                d="M17.42,26.16a15.14,15.14,0,0,0-.22,1.59l-.07.48h0a14.16,14.16,0,0,0-.33-2l-1.82-7.89h-3.5v13h2.07V24.43c0-1.18,0-2.39-.09-3.61h.08l.35,2.3,2,8.19h2.28L20,23c.18-.9.31-1.63.39-2.18h.05q-.09,2-.09,2.94v7.55h2.14v-13H19.13Zm18.36.72h1a3.81,3.81,0,0,0,3-1.24,4.54,4.54,0,0,0,1.14-3.17,4.23,4.23,0,0,0-1-3.08A3.81,3.81,0,0,0,37,18.34H33.29v13h2.49Zm0-6.37h.83a1.62,1.62,0,0,1,1.25.52,2.25,2.25,0,0,1,.48,1.57c0,1.42-.57,2.13-1.7,2.13h-.86Zm-9.24,10.8h2.67l3.31-13H30l-1.8,8.5c-.09.47-.15.92-.19,1.34l-.05.35h-.06a12,12,0,0,0-.2-1.65l-1.8-8.54H23.32ZM25.26,46.75,3.75,25.24,25.24,3.75,46.75,25.26Z"
                transform="translate(-0.25 -0.25)"></path>
        </svg>
        </a>

    <a href="https://twitter.com/yp_code" target="_blank" title="Twitter" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
            </path>
        </svg>
    </a>

    <a href="https://github.com/ypcode" target="_blank" title="GitHub" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path
                d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
        </svg>
    </a>

    <a href="https://www.linkedin.com/in/yannickplenevaux" target="_blank" title="LinkedIn" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
            <path
                d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z">
            </path>
        </svg>
    </a>


</p>
        </div>
    </div>
   
    <div class="site-content">
        <main role="main" class="pb-3">
            <div class="content-item post">
    
    <div class="content-item-title">
        <span class="post-publishing-date">Nov 30, 2016</span>
        <h1>
            Easily extend SharePoint - &quot;Open in a new tab&quot; with JS &amp; PnP PowerShell
            <hr/>
        </h1>
    </div>

        <div class="content-item-featured-image-container">
            <img class="content-item-featured-image" src="/images/common/js.png?r=202007151244" alt="Easily extend SharePoint - "Open in a new tab" with JS & PnP PowerShell" />
        </div>
   
    <div class="content">
        <h1 id="extend-sharepoint-capabilities-easily-with-simple-js-snippets">Extend SharePoint capabilities easily with simple JS snippets</h1>
<p>Sometimes, a useful SharePoint extension does not need any server-side code. In these cases, a simple JS snippet is sufficient. To demonstrate an easy way to deploy SharePoint customizations, I will take a really simple case but quite useful for end-users. from latter upgrades of SharePoint 2013, right-click on the name of a file (in default views) pops up the Edit Control Block. Which is pretty intuitive but has the serious drawback of overriding the standard browser right-click menu, and a particular interesting feature frequently asked. As a SharePoint consultant, I often hear from my customers :</p>
<blockquote>
<p>&quot;I don't want this file to open in-place in my current browser window, can't I have a 'Open in new tab' link as I have it everywhere else with my browser ?&quot;</p>
</blockquote>
<p>There is a convenient way to achieve that, Add this link in the ECB menu. This must be done through custom actions. Wait..., you mean I have to deploy a WSP to have that single link ?</p>
<p>Of course not! Just deploy it through CSOM !</p>
<p>Hopefully, you won't have to code and compile a .NET application for that, the SharePoint</p>
<p>PnP Community already ships a set of PowerShell cmdlets that allows to do all the tricks</p>
<p>You can find all the source code on <a href="https://github.com/OfficeDev/PnP-PowerShell/blob/master/Documentation/readme.md">GitHub</a> and even an <a href="https://github.com/OfficeDev/PnP-PowerShell/tree/master/Binaries">installer</a> to set up all the cmdlets on your workstation</p>
<h2 id="what-do-we-have-to-do">What do we have to do ?</h2>
<ol>
<li>Provision a JS file on the SharePoint that contains all the needed code</li>
<li>Add a script link custom action to the site collection that makes all the pages of the site collection references our script file</li>
<li>Add the proper custom action in the Edit Control Block that calls our JS function</li>
</ol>
<h2 id="the-very-complex-code">The (very complex) code</h2>
<pre><code class="language-javascript">var YPCode = YPCode || {}; 
YPCode.Utils = YPCode.Utils || {}; 
YPCode.Utils.openInNewTab = function (url) { 
  var win = window.open(url, '_blank'); 
  if (win) 
    win.focus(); 
}; 
</code></pre>
<p>It opens the specified URL in a new window (a new tab) and focuses on that tab</p>
<h2 id="the-pnp-cmdlets-used-here">The PnP cmdlets used here :</h2>
<ul>
<li>Add-PnPFile to provision the .js file</li>
<li>Add-PnPJavaScriptLink to reference our JS file in every pages of the site collection (can also be scoped to a single web)</li>
<li>Add-PnPCustomAction to provision the custom action to all lists (by its definition type id)</li>
</ul>
<h2 id="our-own-customization-cmdlet">Our own customization cmdlet</h2>
<pre><code class="language-powershell">[CmdletBinding()] 
Param ( 
  [Parameter(Mandatory=$True, HelpMessage=&quot;The site collection relative URL of the site assets library (without the starting /)&quot;)]
  [string]$SiteAssetsUrl,
  [Parameter(Mandatory=$False)] 
  [int]$ListBaseTemplate=101,
  [Parameter(Mandatory=$False)]
  [string]$JsFileName ) 
  # Default values 
  $defaultJsFileName = &quot;openInNewTab.js&quot; 
  $defaultScriptLinkName = &quot;SLOpenInNewTab&quot; 
  $defaultCustomActionName = &quot;OpenInNewTabCustomAction&quot; 
  $defaultCustomActionTitle = &quot;Open in a new Tab&quot; 
  $defaultCustomActionDescription = &quot;Allows to open a document in a new tab&quot; 
  
  # Create the context if not already existing 
  Try { Get-PnPContext } 
  Catch { Write-Host &quot;Please connect to SharePoint&quot; Connect-PnPOnline } 
  
  If (!$JsFileName) { 
    $JsFileName = $defaultJsFileName 
  } 
  
  # Write the needed JavaScript in a local file 
  $js = &quot;var YPCode = YPCode || {}; YPCode.Utils = YPCode.Utils || {}; YPCode.Utils.openInNewTab = function (url) { var win = window.open(url, '_blank'); if (win) win.focus(); };&quot; 
  $js | Out-File $JsFileName 
  
  # Get the web URL 
  $siteCollUrl = (Get-PnPSite).Url 
  # Upload the JS file 
  Try { 
    $provisionnedFile = Add-PnPFile -Path $JsFileName -Folder $SiteAssetsUrl 
  } 
  Catch { 
    Write-Host The JavaScript file $JsFileName cannot be provisionned to $SiteAssetsUrl 
    Return 
  } 
  
  Try { 
    # Add the script link custom action 
    $jsFileUrl = $siteCollUrl + &quot;/&quot; + $SiteAssetsUrl + &quot;/&quot; + $JsFileName 
    $result = Add-PnPJavaScriptLink -Name $defaultScriptLinkName -Scope Site -Url $jsFileUrl 
    # Add the custom action 
    $result = Add-PnPCustomAction -Name $defaultCustomActionName -Title $defaultCustomActionTitle -Description $defaultCustomActionDescription -RegistrationId $ListBaseTemplate -RegistrationType &quot;List&quot; -Group &quot;SiteActions&quot; -Location &quot;EditControlBlock&quot;  -Url &quot;javascript:YPCode.Utils.openInNewTab('{ItemUrl}');&quot; -Scope Site 
  } Catch { 
    Write-Host The custom actions cannot be added to the target site 
  } 
</code></pre>
<p>Execute this powershell command and <strong>that's it</strong>! You have implemented a simple customization to SharePoint.</p>
<h3 id="the-advantages">The advantages:</h3>
<ul>
<li>No solution package deployment (no downtime, no need for maintenance window)</li>
<li>Done using CSOM (remotely), you can execute this command from any host able to reach your SharePoint site</li>
<li>As valid On-Premises as Online</li>
</ul>
<p>You can now reuse this technique to deploy any customizations implemented in JavaScript (simple or more complex ones).</p>
<p>I hope it will give you ideas for your future customizations.</p>
<p>See you soon!</p>
<p>Yannick</p>

    </div>
</div>
        </main>

        <footer class="border-top footer">
                &copy; Copyrights 2020 - YPcode - Yannick Plenevaux
        </footer>
    </div>


    <script src="/lib/jquery/dist/jquery.min.js"></script>
    <script src="/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/site.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" ></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.js" ></script>

        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-aspnet.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-c.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-clike.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-csharp.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-css-extras.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-scss.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-markup.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-javascript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-jsx.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-powershell.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-typescript.min.js" ></script>
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.js" ></script>



</body>
</html>
